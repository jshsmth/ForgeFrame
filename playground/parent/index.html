<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>ForgeFrame Playground</title>
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/themes/prism.min.css" />
    <style>
      * {
        box-sizing: border-box;
      }
      body {
        font-family: system-ui, -apple-system, sans-serif;
        margin: 0;
        padding: 0;
        background: #f5f5f5;
        color: #333;
        height: 100vh;
        display: flex;
        flex-direction: column;
      }

      /* Header */
      .header {
        background: #fff;
        padding: 0.75rem 1rem;
        border-bottom: 1px solid #e0e0e0;
        display: flex;
        justify-content: space-between;
        align-items: center;
        flex-shrink: 0;
      }
      .header h1 {
        margin: 0;
        font-size: 1rem;
        font-weight: 600;
        color: #333;
      }
      .header h1 span {
        color: #e94560;
      }
      .header-controls {
        display: flex;
        gap: 1rem;
        align-items: center;
      }
      .header-info {
        font-size: 0.7rem;
        color: #888;
      }

      /* Mode Toggle */
      .mode-group {
        display: flex;
        align-items: center;
        gap: 0.5rem;
      }
      .mode-group.disabled {
        opacity: 0.4;
        pointer-events: none;
      }
      .mode-label {
        font-size: 0.65rem;
        text-transform: uppercase;
        letter-spacing: 0.05em;
        color: #666;
      }
      .mode-toggle {
        display: flex;
      }
      .mode-btn {
        padding: 0.35rem 0.6rem;
        border: 1px solid #ddd;
        background: #fff;
        color: #666;
        cursor: pointer;
        font-size: 0.7rem;
        font-weight: 500;
        transition: all 0.15s;
      }
      .mode-btn:first-child {
        border-radius: 4px 0 0 4px;
      }
      .mode-btn:last-child {
        border-radius: 0 4px 4px 0;
      }
      .mode-btn:not(:last-child) {
        border-right: none;
      }
      .mode-btn:hover {
        background: #f5f5f5;
      }
      .mode-btn.active {
        background: #e94560;
        border-color: #e94560;
        color: #fff;
      }

      /* Main 2x2 Grid */
      .main {
        display: grid;
        grid-template-columns: 1fr 1fr;
        grid-template-rows: 1fr 1fr;
        gap: 1px;
        background: #e0e0e0;
        flex: 1;
        min-height: 0;
      }

      /* Panel Base */
      .panel {
        background: #fff;
        display: flex;
        flex-direction: column;
        overflow: hidden;
      }
      .panel-header {
        display: flex;
        justify-content: space-between;
        align-items: center;
        padding: 0.5rem 0.75rem;
        background: #fafafa;
        border-bottom: 1px solid #eee;
        flex-shrink: 0;
      }
      .panel-header h3 {
        margin: 0;
        font-size: 0.65rem;
        text-transform: uppercase;
        letter-spacing: 0.08em;
        color: #888;
        font-weight: 600;
      }
      .panel-content {
        flex: 1;
        overflow: auto;
        min-height: 0;
      }

      /* JSON Editor Panel */
      #json-editor {
        width: 100%;
        height: 100%;
        background: #fff;
        color: #333;
        border: none;
        padding: 0.75rem;
        font-family: 'SF Mono', 'Consolas', monospace;
        font-size: 0.8rem;
        line-height: 1.5;
        resize: none;
        outline: none;
        tab-size: 2;
      }
      .editor-error {
        padding: 0.4rem 0.75rem;
        background: #fff5f5;
        color: #c00;
        font-size: 0.7rem;
        font-family: monospace;
        border-top: 1px solid #fcc;
        display: none;
      }
      .editor-error.visible {
        display: block;
      }

      /* Code Preview Panel */
      .code-preview pre {
        margin: 0;
        padding: 0.75rem;
        font-size: 0.75rem;
        line-height: 1.5;
        background: #fff;
      }
      .code-preview code {
        font-family: 'SF Mono', 'Consolas', monospace;
      }

      /* Component Panel */
      .component-controls {
        display: flex;
        gap: 0.4rem;
        align-items: center;
        padding: 0.5rem 0.75rem;
        background: #fafafa;
        border-bottom: 1px solid #eee;
      }
      .component-controls button {
        padding: 0.35rem 0.6rem;
        border: 1px solid #ddd;
        border-radius: 4px;
        cursor: pointer;
        font-size: 0.7rem;
        font-weight: 500;
        transition: all 0.15s;
      }
      .btn-render {
        background: #28a745;
        border-color: #28a745;
        color: #fff;
      }
      .btn-render:hover {
        background: #218838;
      }
      .btn-render:disabled {
        background: #ccc;
        border-color: #ccc;
        cursor: not-allowed;
      }
      .btn-close {
        background: #dc3545;
        border-color: #dc3545;
        color: #fff;
      }
      .btn-close:hover {
        background: #c82333;
      }
      .btn-close:disabled {
        background: #ccc;
        border-color: #ccc;
        cursor: not-allowed;
      }
      .btn-secondary {
        background: #fff;
        color: #666;
      }
      .btn-secondary:hover {
        background: #f5f5f5;
      }
      .btn-secondary:disabled {
        background: #f5f5f5;
        color: #bbb;
        cursor: not-allowed;
      }
      .controls-spacer {
        flex: 1;
      }
      .status-indicator {
        font-size: 0.7rem;
        color: #888;
        display: flex;
        align-items: center;
        gap: 0.4rem;
      }
      .status-dot {
        width: 6px;
        height: 6px;
        border-radius: 50%;
        background: #ccc;
      }
      .status-dot.rendered {
        background: #28a745;
      }
      .status-dot.error {
        background: #dc3545;
      }

      /* Props Bar */
      .props-bar {
        display: flex;
        gap: 0.75rem;
        padding: 0.5rem 0.75rem;
        background: #fafafa;
        border-bottom: 1px solid #eee;
      }
      .prop-item {
        display: flex;
        align-items: center;
        gap: 0.4rem;
      }
      .prop-item label {
        font-size: 0.65rem;
        color: #888;
        text-transform: uppercase;
      }
      .prop-item input {
        background: #fff;
        border: 1px solid #ddd;
        border-radius: 3px;
        color: #333;
        padding: 0.25rem 0.4rem;
        font-size: 0.75rem;
        font-family: inherit;
        width: 80px;
      }
      .prop-item input:focus {
        outline: none;
        border-color: #e94560;
      }
      .prop-item button {
        padding: 0.25rem 0.5rem;
        background: #fff;
        border: 1px solid #ddd;
        border-radius: 3px;
        color: #666;
        cursor: pointer;
        font-size: 0.65rem;
      }
      .prop-item button:hover {
        background: #f5f5f5;
      }

      /* Component Container */
      #component-container {
        flex: 1;
        margin: 0.75rem;
        border: 2px dashed #ddd;
        border-radius: 6px;
        background: #fafafa;
        position: relative;
        min-height: 0;
      }
      #component-container.has-component {
        border-style: solid;
        border-color: #e94560;
        background: #fff;
      }
      #component-container > div {
        width: 100%;
        height: 100%;
      }
      .container-placeholder {
        position: absolute;
        inset: 0;
        display: flex;
        align-items: center;
        justify-content: center;
        color: #bbb;
        font-size: 0.8rem;
      }
      #component-container.has-component .container-placeholder {
        display: none;
      }

      /* Event Log Panel */
      #event-log {
        padding: 0.5rem 0.75rem;
        font-family: 'SF Mono', 'Consolas', monospace;
        font-size: 0.7rem;
        line-height: 1.7;
      }
      .log-entry {
        color: #666;
      }
      .log-entry .time {
        color: #999;
        margin-right: 0.5rem;
      }
      .log-entry.success {
        color: #28a745;
      }
      .log-entry.error {
        color: #dc3545;
      }
      .log-entry.info {
        color: #0066cc;
      }
    </style>
  </head>
  <body>
    <header class="header">
      <h1><span>Forge</span>Frame Playground</h1>
      <div class="header-controls">
        <div class="mode-group">
          <span class="mode-label">Context</span>
          <div class="mode-toggle">
            <button class="mode-btn active" data-context="iframe">Iframe</button>
            <button class="mode-btn" data-context="popup">Popup</button>
          </div>
        </div>
        <div class="mode-group" id="iframe-style-group">
          <span class="mode-label">Style</span>
          <div class="mode-toggle">
            <button class="mode-btn active" data-style="embedded">Embedded</button>
            <button class="mode-btn" data-style="modal">Modal</button>
          </div>
        </div>
        <div class="header-info">
          localhost:5173 â†’ localhost:5174
        </div>
      </div>
    </header>

    <main class="main">
      <!-- Top Left: JSON Config -->
      <div class="panel">
        <div class="panel-header">
          <h3>Component Options</h3>
          <button class="btn-secondary" id="btn-reset" style="padding: 0.2rem 0.4rem; font-size: 0.65rem;">Reset</button>
        </div>
        <div class="panel-content">
          <textarea id="json-editor" spellcheck="false"></textarea>
        </div>
        <div class="editor-error" id="editor-error"></div>
      </div>

      <!-- Top Right: Component Preview -->
      <div class="panel">
        <div class="component-controls">
          <button class="btn-render" id="btn-render">Render</button>
          <button class="btn-close" id="btn-close" disabled>Close</button>
          <button class="btn-secondary" id="btn-focus" disabled>Focus</button>
          <button class="btn-secondary" id="btn-show" disabled>Show</button>
          <button class="btn-secondary" id="btn-hide" disabled>Hide</button>
          <div class="controls-spacer"></div>
          <div class="status-indicator">
            <span class="status-dot" id="status-dot"></span>
            <span id="status-text">Ready</span>
          </div>
        </div>
        <div class="props-bar">
          <div class="prop-item">
            <label>name</label>
            <input type="text" id="prop-name" value="World" />
            <button id="btn-update-name">Set</button>
          </div>
          <div class="prop-item">
            <label>count</label>
            <input type="number" id="prop-count" value="0" />
            <button id="btn-update-count">Set</button>
          </div>
        </div>
        <div id="component-container">
          <div class="container-placeholder">Click "Render" to load component</div>
        </div>
      </div>

      <!-- Bottom Left: Generated Code -->
      <div class="panel">
        <div class="panel-header">
          <h3>Generated Code</h3>
        </div>
        <div class="panel-content code-preview">
          <pre><code class="language-typescript" id="code-output"></code></pre>
        </div>
      </div>

      <!-- Bottom Right: Events -->
      <div class="panel">
        <div class="panel-header">
          <h3>Events</h3>
          <button class="btn-secondary" id="btn-clear-log" style="padding: 0.2rem 0.4rem; font-size: 0.65rem;">Clear</button>
        </div>
        <div class="panel-content" id="event-log"></div>
      </div>
    </main>

    <script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/prism.min.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/components/prism-typescript.min.js"></script>
    <script type="module" src="./main.ts"></script>
  </body>
</html>
